



Workload Identity in Multi System Environments   A. Schwenkschuster, Ed.
Internet-Draft                                                     SPIRL
Intended status: Informational                           30 January 2025
Expires: 3 August 2025


                       WIMSE Credential Exchange
         draft-schwenkschuster-wimse-credential-exchange-latest

Abstract

   WIMSE defines Workload Identity and how it is represented in the form
   of a credential.  In most situations it is provisioned to the
   workload or the workload is able to request it without further
   authentication.

   Regardless of the delivery, the credential format is often given
   based on the platform, often in the form of JWT and not a choice of
   the workload.  Many situations however, require the workload to use a
   credential in a different form, with specific, alternative
   identifiers or in a different trust domain.  Often existing protocols
   exist on how this can be acchieved.  For instance OAuth2 Token
   Exchange (TODO) for JSON Web Tokens or ACME (TODO) for X.509
   certificates.

   This document aims to outline the situations where a credential
   exchange is necessary and what guard rails should exist.  To ease
   integration for workloads requiring a set of different identity
   represented in a whole set of credentials shapes it proposes a way to
   retrieve them in a standardized manner.

About This Document

   This note is to be removed before publishing as an RFC.

   The latest revision of this draft can be found at https://ietf-wg-
   wimse.github.io/draft-ietf-wimse-s2s-protocol/draft-ietf-wimse-s2s-
   protocol.html.  Status information for this document may be found at
   https://datatracker.ietf.org/doc/draft-schwenkschuster-wimse-
   credential-exchange/.

   Discussion of this document takes place on the Workload Identity in
   Multi System Environments Working Group mailing list
   (mailto:wimse@ietf.org), which is archived at
   https://mailarchive.ietf.org/arch/browse/wimse/.  Subscribe at
   https://www.ietf.org/mailman/listinfo/wimse/.

   Source for this draft and an issue tracker can be found at
   https://github.com/arndt-s.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 3 August 2025.

Copyright Notice

   Copyright (c) 2025 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Reasons
       1.1.1.  Change in format
       1.1.2.  Change in scope
       1.1.3.  Change in identity
       1.1.4.  Change in authority or trust domain
       1.1.5.  Missing provisioning support
       1.1.6.  Combinations
     1.2.  Provisioning, re-previsioning & exchange
     1.3.  Exchange patterns
       1.3.1.  Format-specific exchange
       1.3.2.  On-behalf-of exchange
   2.  Consideration
   3.  Conventions and Definitions
   4.  Security Considerations
   5.  IANA Considerations
   6.  Normative References
   Acknowledgments
   Author's Address

1.  Introduction

   Workload Identity credentials come in all shapes and forms.  JSON Web
   Tokens are popular but also X.509 certificates are commonly used.
   Generally it can be assumed that the workload receives all of the
   following

   *  an identity as a unique identifier within the trust domain

   *  one or multiple credentials that allow it to represent itself (as
      that identity).  Multiple credentials are often different types
      but representing the same identity.

   *  an indication of authority.  (TODO not sure)

   Identity, credential and authority enable the workload to interact
   within its environment, communicate to sibling workloads (same
   authority), access APIs inside that trust domain or provide an API
   itself.

1.1.  Reasons

1.1.1.  Change in format

   A different format representing the same identity on the same logical
   authority.  These can be due to many reasons but concrete examples
   could be

   *  initial credential was a X.509 certificate but infrastructure
      requires application-level authentication such as JWT.

   *  initial credential was a JWT bound to a key, requiring to be
      presented along with proof of possession but the peer does not
      support it and requires a Bearer credential.

   A change in format is often in control of the workload.  Some
   frameworks and protocols exist where the credential format is not
   choosen by the workload but the authority.  The returning credential
   is opague to the workload, for instance OAuth Bearer Tokens (TODO).

1.1.2.  Change in scope

   A credential in the same format representing the same identity but
   scoped differently.  Examples are:

   *  A JWT credential audienced to interact with the Workload platform
      but access to other workloads are required.  The workload is in
      need of JWTs with different, dedicated audiences.

   *  A X.509 credential allowing the workload to TODO based on X.509
      Key Usage extension but the workload requires additonal usages.

   Generally, scope should already be present and configured
   approperately with the workload platform only issuing narrowly scoped
   credentials to the workload.

   In some situation the platform may only support the provisioning of a
   single credential and not support scoping it.  If those cannot be
   requested by the platform itself an exchange may be necessary.

1.1.3.  Change in identity

   A workload may be known under multiple identities.  For example:

   *  A workload identity representing an exact physical instance may be
      eligable for a workload identity representing a logical unit that
      consists of many phyiscal instances.  Another example is a
      workload running in a specific region being eligable for a more
      broader, geo scoped identity.

   *  A workload that can act on behalf of other workloads.  These
      workloads often are part of infrastructure such as API-Gateways,
      proxies or service meshes in container environments.

1.1.4.  Change in authority or trust domain

   A provisioned workload identity is often part of a trust domain that
   is coupled to infrastructure or deployment.  Workloads often require
   to intercept with other workloads or access outside resources that
   are protected by other authorities or reside in different trust
   domains.  This requires the client workload to retrieve an identity
   of the other trust domain.  Examples here include:

   *  Federation (a workload identity federates to a identity in a
      different trust domain).  In existing workload identity
      environment OAuth2 with Token Exchange (TODO) and Assertion
      framework (TODO) are popular.

   *  A workload requires a credential of "higher trust" to interact
      with other workloads.  This "higher trust" is facilitated by
      another authority.  For instance a workload requiring a WebPKI
      certificate to offer a service to the world wide web.

1.1.5.  Missing provisioning support

   A workload platform may not support the provisioning of credentials
   required by the workload.  Technically, any of these would likely
   fall under the reasons above but it's a very common reason and often
   falls into multiple categories.  As an example:

   *  Workload platform provisions identity & credential in the form of
      a simple signed document that carries the attributes attested by
      the platform but gives not access in any way.

1.1.6.  Combinations

   Reasons to exchange credentials are often not binary.  A change in
   authority effectively is a change in identity and a change in format
   is also often a change in authority as often formats come with
   different authority structures and security promises.

1.2.  Provisioning, re-previsioning & exchange

   Once a workload has identified the need of a different credential it
   has multiple option to retrieve it.  Based on the reason the list of
   options differs.  This speciciation differs between the following 3
   main options:

   Provisiong
      The initial credential(s) the workload is provisioned with are
      modified.  This is often a matter of configuration within the
      platform.  For instance a service account token in Kubernetes is
      projected with a different audience.  Or a new credential is
      provisioned alongside the existing credential.

   Re-provisioning
      Workloads are able to request credentials without authentication.
      This can be in addition to an initial credential or the way the
      initial credential is delivered in the first place.  This approach
      allows the workload to request credential in the exact format,
      scope and identity it requires.

   Credential exchange
      Workload use a provisioned credential to authenticate a delivery
      of a different credential.  The significant difference here is
      that this is an authenticated action, compared to the other above,
      which are unauthenticated.

   If a workload is in need of a different format, identity or scope it
   is always reccomended to use the initial provisioning or re-
   provisioning instead of a credential exchange.  These approaches have
   generally a higher assurance and are more secure than exchange an
   already provisioned credential.

   The following table gives some guidance based on the reason a
   different credential is required:

      +===========+=====================+==========================+
      | Reason    | Preferred mechanism | Other options (in order) |
      +===========+=====================+==========================+
      | Change in | Credential exchange | None                     |
      | authority |                     |                          |
      +-----------+---------------------+--------------------------+
      | Change in | Provisioning        | 1) Re-provisioning       |
      | identity  |                     | 2) credential exchange   |
      +-----------+---------------------+--------------------------+
      | Change in | Provisioning        | 1) Re-provisioning       |
      | scope     |                     | 2) credential exchange   |
      +-----------+---------------------+--------------------------+
      | Change in | Provisioning        | 1) Re-provisioning       |
      | format    |                     | 2) credential exchange   |
      +-----------+---------------------+--------------------------+

                                 Table 1

1.3.  Exchange patterns

1.3.1.  Format-specific exchange

   Existing trust & identity framework often consist of a protocol or
   framework to exchange credentials.  Leveraging this makes use of
   existing adoption and specific guidelines.

   The following bullets give an overview of the existing patterns and
   when to use them based on the reasons given above:

   *  OAuth Token Exchange (TODO):

      -  Change in scope.

      -  Change in identity.

      -  NOT meant for a change in authority.

      -  NOT meant for a change in format.

   *  OAuth Assertion Framework (TODO):

      -  Change in authority.

      -  As a result of the change in authority, a change in identity,
         scope & potentially format is unavoidable but not the primary
         use case.

      -  NOT meant for inter-domain exchanges.

   *  X.509 Certificate Management Protocol [RFC4210]:

      -  Is this valid here?  If yes, write about it.

   *  Enrollment over Secure Transport [RFC7030]:

      -  Profile of [RFC4210]?

      -  Is this valid here?  If yes, write about it.

   *  SPIFFE federation:

      -  Not a credential exchange but rather allowing for identities of
         different authorities to trust each other and communicate
         securely.

1.3.2.  On-behalf-of exchange

   Workload environments can be highly dynamic and connected with a high
   variety of resources protected by different identity frameworks and
   formats.  A format-agnostic, exchange component that exchanges
   credentials on behalf of the workload may be desired to remain
   control of credential issuance.  For instance to enforce policy,
   collect audit trails or ease management.

+-----------------+ 2)request     +------------------------+  4)request      +-------------+
|                 |   credential  |                        |    credential   |             |
|  Workload       +-------------->|  Credential Exchanger  +---------------->|  Authority  |
|                 |               |                        |                 |             |
+-------^---------+               +----------+-------------+                 +-------------+
        |                                    |
  1)initial provisioning                     |
        |                              3) validate
+-------+-----------------+                  |
|                         |                  |
|  Workload Platform      |<-----------------+
|                         |
+-------------------------+

   The author believes that a specific protocol that fits all credential
   formats and trust frameworks is not feasable while remaining the
   existing security promises of the format or framework.  It rather
   believes that a profile for each scenario is the best way forward and
   welcomes them to profile this specificiation for their concrete use
   cases.  As a general guidance it is reccommended * to narrowly scope
   the scenarios and don't build a one-fits-all exchange for a specific
   format. * to decouple authentication and access control from the
   actual exchange as best as possible.  E.g. a credential of one
   profile should be allowed as a mean of authentication to exchange to
   a credential of a different profile, regardless if the profiles are
   aware of each other or not.

   The "Credential Exchanger" shown in the figure may be the Workload
   Platform itself that offers this capability.  Potentially also in a
   "re-provisioning" way without authentication.

2.  Consideration

3.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

4.  Security Considerations

   TODO Security

5.  IANA Considerations

   This document has no IANA actions.

6.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC4210]  Adams, C., Farrell, S., Kause, T., and T. Mononen,
              "Internet X.509 Public Key Infrastructure Certificate
              Management Protocol (CMP)", RFC 4210,
              DOI 10.17487/RFC4210, September 2005,
              <https://www.rfc-editor.org/rfc/rfc4210>.

   [RFC7030]  Pritikin, M., Ed., Yee, P., Ed., and D. Harkins, Ed.,
              "Enrollment over Secure Transport", RFC 7030,
              DOI 10.17487/RFC7030, October 2013,
              <https://www.rfc-editor.org/rfc/rfc7030>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

Acknowledgments

   TODO acknowledge.

Author's Address

   Arndt Schwenkschuster (editor)
   SPIRL
   Email: arndts.ietf@gmail.com
